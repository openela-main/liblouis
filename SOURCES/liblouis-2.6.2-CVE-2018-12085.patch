From dbfa58bb128cae86729578ac596056b3385817ef Mon Sep 17 00:00:00 2001
From: Christian Egli <christian.egli@sbs.ch>
Date: Wed, 6 Jun 2018 16:41:53 +0200
Subject: [PATCH] Check index before writing to result->chars

Fixes #595

Index: liblouis-2.6.4/liblouis/compileTranslationTable.c
===================================================================
--- liblouis-2.6.4.orig/liblouis/compileTranslationTable.c
+++ liblouis-2.6.4/liblouis/compileTranslationTable.c
@@ -1517,12 +1517,12 @@ parseChars (FileInfo * nested, CharsStri
 		}
 	      in++;
 	    }
-	  result->chars[out++] = (widechar) ch;
 	  if (out >= MAXSTRING)
 	    {
 	      result->length = out;
 	      return 1;
 	    }
+	  result->chars[out++] = (widechar) ch;
 	  continue;
 	}
       lastOutSize = out;
